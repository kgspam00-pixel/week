<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Valentine’s Day ❤️</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Inter:wght@300;400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="../style.css" />

<style>
.val-title { font-size: 32px; margin-bottom: 14px; }
.val-sub { font-size: 18px; opacity: .85; margin-bottom: 28px; }

.phase { display:none; animation: fadeIn .7s ease; }

.moment { margin: 22px 0; font-size: 22px; line-height: 1.6; }
.build { margin: 28px 0; font-size: 21px; font-style: italic; opacity: .85; }
.deep { margin: 24px 0; font-size: 22px; }

.next-btn {
  margin-top: 18px;
  padding: 12px 22px;
  border-radius: 22px;
  border: none;
  background: #f1e4ff;
  cursor: pointer;
}

/* question */

.question {
  margin-top: 40px;
  font-size: 30px;
  font-weight: 600;
}

.choices {
  position: relative;
  margin-top: 28px;
  height: 100px;
}

.choices button {
  font-size: 16px;
  padding: 12px 26px;
}

#yesBtn {
  position: absolute;
  left: 50%;
  transform: translateX(-110px);
}

#noBtn {
  position: absolute;
  left: 50%;
  transform: translateX(20px);
}

/* finale */

.ending {
  font-size: 24px;
  font-weight: 500;
  margin-top: 36px;
}

/* particles */

.particle {
  position: fixed;
  font-size: 22px;
  animation: explode 1.8s ease forwards;
  pointer-events: none;
}

@keyframes explode {
  to {
    transform: translate(var(--x), var(--y));
    opacity: 0;
  }
}
</style>
</head>

<body>

<main class="week">

<!-- LOCKED -->
<section id="locked" style="display:none;">
  <h1>Not yet ❤️</h1>
  <p class="subtitle">
    The best things wait for their moment.
  </p>
</section>

<!-- UNLOCKED -->
<section id="unlocked" style="display:none;">

<h1 class="val-title">Valentine’s Day ❤️</h1>
<p class="val-sub">Stay with me for this one.</p>

<!-- PHASE 1 — YOUR ORIGINAL CORE -->
<div class="phase" id="p1">

<p class="moment">Over this week, I gave you pieces of how I feel.</p>

<p class="moment">
The softness.  
The laughter.  
The comfort.  
The desire.  
The choice.
</p>

<p class="moment">
But the truth is simpler than all of that.
</p>

<p class="build">I feel at home with you.</p>

<button class="next-btn" onclick="nextPhase()">Keep reading</button>
</div>

<!-- PHASE 2 — NEW VULNERABLE EXPANSION -->
<div class="phase" id="p2">

<p class="deep">
I don’t say things like this lightly.
</p>

<p class="deep">
I’m not impulsive with my heart.  
I’m careful. Protective. Slow.
</p>

<p class="deep">
And yet with you —  
I didn’t fall by accident.
I walked in knowingly.
</p>

<p class="deep">
You are not a phase to me.  
Not a distraction.  
Not a maybe.
</p>

<p class="deep">
You are a decision I keep making — calmly, clearly, daily.
</p>

<p class="build">
Not because I have to.  
Because I want to.
</p>

<button class="next-btn" onclick="nextPhase()">One more thing</button>
</div>

<!-- PHASE 3 — ASK -->
<div class="phase" id="p3">

<p class="moment">
No metaphors now.  
No build-up left.
</p>

<p class="question">
Will you be my Valentine?
</p>

<div class="choices">
  <button id="yesBtn">Yes ❤️</button>
  <button id="noBtn">No</button>
</div>

<div id="afterYes" style="display:none;">
  <p class="ending">
    I knew it.<br>
    I just wanted to hear it from you.
  </p>
  <p class="footer">
    I choose you. Always.
  </p>
</div>

</div>
<div class="back">
      <a href="../index.html">← Back to the diary</a>
    </div>
</section>

</main>

<script src="../week.js"></script>

<script>
handleDayUnlock("valentine");
markProgress("valentine");

/* phase flow */
let phase = 1;
document.getElementById("p1").style.display = "block";

function nextPhase(){
  document.getElementById("p"+phase).style.display="none";
  phase++;
  document.getElementById("p"+phase).style.display="block";
}

/* yes/no logic */

const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");
const afterYes = document.getElementById("afterYes");

let triedOnce = false;

yesBtn?.addEventListener("click", (e) => {
  celebrate(e.clientX, e.clientY);
  afterYes.style.display="block";
  yesBtn.style.display="none";
  noBtn.style.display="none";
});

noBtn?.addEventListener("click", () => {
  if (!triedOnce){
    triedOnce = true;
    noBtn.innerText = "Try again";
  }
});

function dodge(){
  if (!triedOnce) return;
  noBtn.style.transform =
   `translate(${Math.random()*160-80}px,
              ${Math.random()*60-30}px)`;
}

noBtn?.addEventListener("mouseenter", dodge);
noBtn?.addEventListener("touchstart", dodge);

/* heart explosion */

function celebrate(x,y){
  for(let i=0;i<36;i++){
    const p=document.createElement("div");
    p.className="particle";
    p.innerText=Math.random()>0.5?"❤️":"♡";
    const a=Math.random()*Math.PI*2;
    const d=160+Math.random()*120;
    p.style.left=x+"px";
    p.style.top=y+"px";
    p.style.setProperty("--x",Math.cos(a)*d+"px");
    p.style.setProperty("--y",Math.sin(a)*d+"px");
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),1800);
  }
}
</script>

</body>
</html>
